{"ast":null,"code":"import _slicedToArray from \"D:\\\\MOZZHUB-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\MOZZHUB-ReactJS\\\\src\\\\component\\\\test.js\";\nimport React, { useState } from 'react';\nimport { Map, TileLayer, Marker, Circle, Polyline } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css'; // Fix for default marker icon issue\n\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\n}); // Haversine distance function to calculate distance between two coordinates\n\nvar haversineDistance = function haversineDistance(coords1, coords2) {\n  var toRad = function toRad(x) {\n    return x * Math.PI / 180;\n  };\n\n  var R = 6371e3; // Earth radius in meters\n\n  var lat1 = coords1[0];\n  var lon1 = coords1[1];\n  var lat2 = coords2[0];\n  var lon2 = coords2[1];\n  var dLat = toRad(lat2 - lat1);\n  var dLon = toRad(lon2 - lon1);\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n}; // Function to check if a patient's location is within a cluster's radius\n\n\nvar isWithinCluster = function isWithinCluster(patientCoords, clusterCenter, clusterRadius) {\n  var distance = haversineDistance(patientCoords, clusterCenter);\n  var withinCluster = distance <= clusterRadius;\n  console.log(\"Patient at \".concat(patientCoords, \" is \").concat(withinCluster ? \"within\" : \"not within\", \" the cluster (distance: \").concat(distance.toFixed(2), \" meters)\"));\n  return withinCluster;\n}; // Custom icons for patient locations (black circles)\n\n\nvar patientIcon = new L.DivIcon({\n  html: \"<div style=\\\"background-color: #000000; width: 10px; height: 10px; border-radius: 50%;\\\"></div>\",\n  className: '',\n  iconSize: [10, 10]\n}); // Custom icon for visited locations (orange circles)\n\nvar visitIcon = new L.DivIcon({\n  html: \"<div style=\\\"background-color: #FFA500; width: 10px; height: 10px; border-radius: 50%;\\\"></div>\",\n  className: '',\n  iconSize: [10, 10]\n}); // Custom icon for visited locations within hotspot (red circles)\n\nvar hotspotVisitIcon = new L.DivIcon({\n  html: \"<div style=\\\"background-color: #FF0000; width: 10px; height: 10px; border-radius: 50%;\\\"></div>\",\n  className: '',\n  iconSize: [10, 10]\n});\n\nvar TestFunc = function TestFunc() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedDot = _useState2[0],\n      setSelectedDot = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedHotspot = _useState4[0],\n      setSelectedHotspot = _useState4[1];\n\n  var lat = 1.3521;\n  var lng = 103.8198; // Updated patient data structure with more locations\n\n  var patientData = [{\n    id: 1,\n    position: [1.3521, 103.8198],\n    visits: [[1.3621, 103.8198], [1.3721, 103.8198]]\n  }];\n  var hotspots = [{\n    id: 1,\n    center: [1.3521, 103.8198],\n    radius: 400\n  }]; // Function to handle marker click\n\n  var handleMarkerClick = function handleMarkerClick(id) {\n    setSelectedDot(id);\n  }; // Function to handle hotspot click\n\n\n  var handleHotspotClick = function handleHotspotClick(id) {\n    setSelectedDot(null);\n    setSelectedHotspot(id);\n    var hotspotData = hotspots.find(function (hotspot) {\n      return hotspot.id === id;\n    });\n\n    if (hotspotData) {\n      console.log(\"Hotspot \".concat(id, \" selected\"));\n      patientData.forEach(function (patient) {\n        var isPatientWithinCluster = isWithinCluster(patient.position, hotspotData.center, hotspotData.radius);\n\n        if (isPatientWithinCluster) {\n          console.log(\"Patient \".concat(patient.id, \" is within the cluster at \").concat(hotspotData.center));\n        }\n\n        patient.visits.forEach(function (visit, index) {\n          var isVisitWithinCluster = isWithinCluster(visit, hotspotData.center, hotspotData.radius);\n\n          if (isVisitWithinCluster) {\n            console.log(\"Patient \".concat(patient.id, \"'s visit \").concat(index + 1, \" at \").concat(visit, \" is within the cluster at \").concat(hotspotData.center));\n          }\n        });\n      });\n    }\n  };\n\n  var selectedHotspotData = hotspots.find(function (hotspot) {\n    return hotspot.id === selectedHotspot;\n  });\n  return React.createElement(Map, {\n    center: [lat, lng],\n    zoom: 13,\n    style: {\n      width: '100%',\n      height: '600px',\n      margin: 'auto'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }), patientData.map(function (patient) {\n    return React.createElement(Marker, {\n      key: patient.id,\n      position: patient.position,\n      icon: patientIcon,\n      eventHandlers: {\n        click: function click() {\n          return handleMarkerClick(patient.id);\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, selectedDot === patient.id && patient.visits.map(function (visit, index) {\n      return React.createElement(Polyline, {\n        key: index,\n        positions: [patient.position, visit],\n        color: \"black\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      });\n    }));\n  }), hotspots.map(function (hotspot) {\n    return React.createElement(Circle, {\n      key: hotspot.id,\n      center: hotspot.center,\n      radius: hotspot.radius,\n      color: \"red\",\n      fillColor: \"red\",\n      fillOpacity: 0.3,\n      eventHandlers: {\n        click: function click() {\n          return handleHotspotClick(hotspot.id);\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    });\n  }), selectedHotspotData && React.createElement(React.Fragment, null, patientData.map(function (patient) {\n    return isWithinCluster(patient.position, selectedHotspotData.center, selectedHotspotData.radius) && React.createElement(Marker, {\n      key: \"patient-\".concat(patient.id),\n      position: patient.position,\n      icon: patientIcon,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    });\n  }), patientData.map(function (patient) {\n    return patient.visits.map(function (visit, index) {\n      return isWithinCluster(visit, selectedHotspotData.center, selectedHotspotData.radius) && React.createElement(Marker, {\n        key: \"visit-\".concat(patient.id, \"-\").concat(index),\n        position: visit,\n        icon: hotspotVisitIcon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      });\n    });\n  })), hotspots.map(function (hotspot) {\n    return patientData.map(function (patient) {\n      return isWithinCluster(patient.position, hotspot.center, hotspot.radius) && React.createElement(Polyline, {\n        key: \"connection-\".concat(patient.id, \"-\").concat(hotspot.id),\n        positions: [patient.position, hotspot.center],\n        color: \"blue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      });\n    });\n  }));\n};\n\nexport default TestFunc;","map":{"version":3,"sources":["D:\\MOZZHUB-ReactJS\\src\\component\\test.js"],"names":["React","useState","Map","TileLayer","Marker","Circle","Polyline","L","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","haversineDistance","coords1","coords2","toRad","x","Math","PI","R","lat1","lon1","lat2","lon2","dLat","dLon","a","sin","cos","c","atan2","sqrt","isWithinCluster","patientCoords","clusterCenter","clusterRadius","distance","withinCluster","console","log","toFixed","patientIcon","DivIcon","html","className","iconSize","visitIcon","hotspotVisitIcon","TestFunc","selectedDot","setSelectedDot","selectedHotspot","setSelectedHotspot","lat","lng","patientData","id","position","visits","hotspots","center","radius","handleMarkerClick","handleHotspotClick","hotspotData","find","hotspot","forEach","patient","isPatientWithinCluster","visit","index","isVisitWithinCluster","selectedHotspotData","width","height","margin","map","click"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { Map, TileLayer, Marker, Circle, Polyline } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n// Fix for default marker icon issue\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n    iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\r\n    iconUrl: require('leaflet/dist/images/marker-icon.png'),\r\n    shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\r\n});\r\n\r\n// Haversine distance function to calculate distance between two coordinates\r\nconst haversineDistance = (coords1, coords2) => {\r\n    const toRad = (x) => x * Math.PI / 180;\r\n    const R = 6371e3; // Earth radius in meters\r\n\r\n    const lat1 = coords1[0];\r\n    const lon1 = coords1[1];\r\n    const lat2 = coords2[0];\r\n    const lon2 = coords2[1];\r\n\r\n    const dLat = toRad(lat2 - lat1);\r\n    const dLon = toRad(lon2 - lon1);\r\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\r\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\r\n    return R * c;\r\n};\r\n\r\n// Function to check if a patient's location is within a cluster's radius\r\nconst isWithinCluster = (patientCoords, clusterCenter, clusterRadius) => {\r\n    const distance = haversineDistance(patientCoords, clusterCenter);\r\n    const withinCluster = distance <= clusterRadius;\r\n    console.log(`Patient at ${patientCoords} is ${withinCluster ? \"within\" : \"not within\"} the cluster (distance: ${distance.toFixed(2)} meters)`);\r\n    return withinCluster;\r\n};\r\n\r\n// Custom icons for patient locations (black circles)\r\nconst patientIcon = new L.DivIcon({\r\n    html: `<div style=\"background-color: #000000; width: 10px; height: 10px; border-radius: 50%;\"></div>`,\r\n    className: '',\r\n    iconSize: [10, 10]\r\n});\r\n\r\n// Custom icon for visited locations (orange circles)\r\nconst visitIcon = new L.DivIcon({\r\n    html: `<div style=\"background-color: #FFA500; width: 10px; height: 10px; border-radius: 50%;\"></div>`,\r\n    className: '',\r\n    iconSize: [10, 10]\r\n});\r\n\r\n// Custom icon for visited locations within hotspot (red circles)\r\nconst hotspotVisitIcon = new L.DivIcon({\r\n    html: `<div style=\"background-color: #FF0000; width: 10px; height: 10px; border-radius: 50%;\"></div>`,\r\n    className: '',\r\n    iconSize: [10, 10]\r\n});\r\n\r\nconst TestFunc = () => {\r\n    const [selectedDot, setSelectedDot] = useState(null);\r\n    const [selectedHotspot, setSelectedHotspot] = useState(null);\r\n    const lat = 1.3521;\r\n    const lng = 103.8198;\r\n\r\n    // Updated patient data structure with more locations\r\n    const patientData = [\r\n        { id: 1, position: [1.3521, 103.8198], visits: [[1.3621, 103.8198], [1.3721, 103.8198]] },\r\n        // { id: 2, position: [1.3621, 103.8298], visits: [[1.3521, 103.8198], [1.3821, 103.8198]] },\r\n        // { id: 3, position: [1.3721, 103.8398], visits: [[1.3621, 103.8298], [1.3521, 103.8198]] },\r\n        // { id: 4, position: [1.3821, 103.8498], visits: [[1.3721, 103.8398], [1.3621, 103.8298]] },\r\n        // { id: 5, position: [1.3921, 103.8598], visits: [[1.3821, 103.8498], [1.3721, 103.8398]] }\r\n    ];\r\n\r\n    const hotspots = [\r\n        { id: 1, center: [1.3521, 103.8198], radius: 400 },\r\n        // { id: 2, center: [1.3621, 103.8298], radius: 400 },\r\n        // { id: 3, center: [1.3721, 103.8398], radius: 400 }\r\n    ];\r\n\r\n    // Function to handle marker click\r\n    const handleMarkerClick = (id) => {\r\n        setSelectedDot(id);\r\n    };\r\n\r\n    // Function to handle hotspot click\r\n    const handleHotspotClick = (id) => {\r\n        setSelectedDot(null);\r\n        setSelectedHotspot(id);\r\n\r\n        const hotspotData = hotspots.find(hotspot => hotspot.id === id);\r\n        if (hotspotData) {\r\n            console.log(`Hotspot ${id} selected`);\r\n            patientData.forEach(patient => {\r\n                const isPatientWithinCluster = isWithinCluster(patient.position, hotspotData.center, hotspotData.radius);\r\n                if (isPatientWithinCluster) {\r\n                    console.log(`Patient ${patient.id} is within the cluster at ${hotspotData.center}`);\r\n                }\r\n                patient.visits.forEach((visit, index) => {\r\n                    const isVisitWithinCluster = isWithinCluster(visit, hotspotData.center, hotspotData.radius);\r\n                    if (isVisitWithinCluster) {\r\n                        console.log(`Patient ${patient.id}'s visit ${index + 1} at ${visit} is within the cluster at ${hotspotData.center}`);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    const selectedHotspotData = hotspots.find(hotspot => hotspot.id === selectedHotspot);\r\n\r\n    return (\r\n        <Map center={[lat, lng]} zoom={13} style={{ width: '100%', height: '600px', margin: 'auto' }}>\r\n            <TileLayer\r\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n            />\r\n\r\n            {patientData.map(patient => (\r\n                <Marker key={patient.id} position={patient.position} icon={patientIcon} eventHandlers={{ click: () => handleMarkerClick(patient.id) }}>\r\n                    {selectedDot === patient.id && patient.visits.map((visit, index) => (\r\n                        <Polyline key={index} positions={[patient.position, visit]} color='black' />\r\n                    ))}\r\n                </Marker>\r\n            ))}\r\n\r\n            {hotspots.map(hotspot => (\r\n                <Circle\r\n                    key={hotspot.id}\r\n                    center={hotspot.center}\r\n                    radius={hotspot.radius}\r\n                    color=\"red\"\r\n                    fillColor=\"red\"\r\n                    fillOpacity={0.3}\r\n                    eventHandlers={{ click: () => handleHotspotClick(hotspot.id) }}\r\n                />\r\n            ))}\r\n\r\n            {selectedHotspotData && (\r\n                <>\r\n                    {patientData.map(patient => (\r\n                        isWithinCluster(patient.position, selectedHotspotData.center, selectedHotspotData.radius) && \r\n                        <Marker key={`patient-${patient.id}`} position={patient.position} icon={patientIcon} />\r\n                    ))}\r\n\r\n                    {patientData.map(patient => (\r\n                        patient.visits.map((visit, index) => (\r\n                            isWithinCluster(visit, selectedHotspotData.center, selectedHotspotData.radius) && \r\n                            <Marker key={`visit-${patient.id}-${index}`} position={visit} icon={hotspotVisitIcon} />\r\n                        ))\r\n                    ))}\r\n                </>\r\n            )}\r\n\r\n            {hotspots.map(hotspot => (\r\n                patientData.map(patient => (\r\n                    isWithinCluster(patient.position, hotspot.center, hotspot.radius) && \r\n                    <Polyline key={`connection-${patient.id}-${hotspot.id}`} positions={[patient.position, hotspot.center]} color='blue' />\r\n                ))\r\n            ))}\r\n        </Map>\r\n    );\r\n};\r\n\r\nexport default TestFunc;\r\n\r\n"]},"metadata":{},"sourceType":"module"}