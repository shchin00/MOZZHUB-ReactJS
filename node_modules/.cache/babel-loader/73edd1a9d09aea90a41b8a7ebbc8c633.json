{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\MOZZHUB-ReactJS\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\MOZZHUB-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\MOZZHUB-ReactJS\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\MOZZHUB-ReactJS\\\\src\\\\component\\\\interactiveMap.js\";\n// import React, {useState} from 'react';\n// import { Map, TileLayer, Tooltip, Circle, Polyline } from 'react-leaflet';\n// import { Button } from 'semantic-ui-react';\n// const dummyRanking = [\n//     { lat: 1.462251, lng:  110.413307, ranking: 0.8 }, // London\n//     { lat: 1.468643, lng: 110.428541, ranking: 0.6 }, // New York\n//     { lat:  1.472410, lng: 110.420440, ranking: 0.4 }, // Los Angeles\n//     // { lat: 41.8781, lng: -87.6298, ranking: 0.5 }, // Chicago\n//     // { lat: 37.7749, lng: -122.4194, ranking: 0.7 } // San Francisco\n// ];\n// // const url = \"http://mozzhub.fcsit.unimas.my/mozzhubAPI/mobMapData/T1369\";\n// // async function fetchData() {\n// //     try {\n// //         const response = await fetch(url);\n// //         if (!response.ok) {\n// //             throw new Error('Network response was not ok ' + response.statusText);\n// //         }\n// //         const data = await response.json();\n// //         data.forEach(item => {\n// //             console.log(`Case ID: ${item.Case_id}, Latitude: ${item.lat}, Longitude: ${item.lng}`);\n// //         });\n// //     } catch (error) {\n// //         console.error('There was a problem with the fetch operation:', error);\n// //     }\n// // }\n// // fetchData();\n// const interactiveMap = () => {\n//     const lat = 1.462251; // Initial map center latitude\n//     const lng = 110.413307; // Initial map center longitude\n//     const[hideLine, setHideLine] = useState(false)\n//     const handleClick = ()=>{\n//         setHideLine(!hideLine);\n//     }\n//     const controlPoints = []; // Array to store control points for curves\n//     // Calculate control points\n//     for (let i = 0; i < dummyRanking.length - 1; i++) {\n//         const p1 = [dummyRanking[i].lat, dummyRanking[i].lng];\n//         const p2 = [dummyRanking[i + 1].lat, dummyRanking[i + 1].lng];\n//         const controlPoint = [\n//             (p1[0] + p2[0]) / 2, // Midpoint of latitudes\n//             (p1[1] + p2[1]) / 2, // Midpoint of longitudes\n//         ];\n//         controlPoints.push(controlPoint);\n//     }\n//     return (\n//         <div>\n//         <Map center={[lat, lng]} zoom={13} style={{ width: '100%', height: '620px', margin: 'auto' }}>\n//             <TileLayer\n//                 attribution=\"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors\"\n//                 url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n//                 maxZoom={16}\n//                 minZoom={2}\n//             />\n//             {dummyRanking.map((elem, i) => {\n//                 var l = (0.9 - dummyRanking[i].ranking * 0.9) * 255;\n//                 var h = (0.9 - dummyRanking[i].ranking * 0.9) * 240;\n//                 var a = dummyRanking[i].ranking * 0.9;\n//                 var rgb = \"rgb(255,\" + l + \",\" + l + \")\";\n//                 return (\n//                     <Circle\n//                         key={i}\n//                         center={{ lat: dummyRanking[i].lat, lng: dummyRanking[i].lng }}\n//                         color='red' \n//                         fillColor={rgb}\n//                         fillOpacity={a}\n//                         radius={50}\n//                         onClick={handleClick}\n//                         >\n//                         <Tooltip><h3>Ranking:#{i + 1}</h3></Tooltip>\n//                     </Circle>\n//                 )\n//             })}\n//             {/* Render curved lines between circles */}\n//             {!hideLine && dummyRanking.length > 1 && controlPoints.map((controlPoint, i) => (\n//                 <Polyline\n//                     key={i}\n//                     positions={[\n//                         [dummyRanking[i].lat, dummyRanking[i].lng], // Start point\n//                         controlPoint, // Control point\n//                         [dummyRanking[i + 1].lat, dummyRanking[i + 1].lng], // End point\n//                     ]}\n//                     color=\"blue\"\n//                 />\n//             ))}\n//         </Map>\n//         <div style={{ display: 'flex', flexDirection: 'column', marginLeft: '10px' }}>\n//         <div style={{margin: \"2px\", border: \"2px solid black\"}}>\n//                 <p style={{margin: \"2px\"}}>Map Legend:</p>\n//                 <p style={{margin: \"2px\"}}>Circle: Data points</p>\n//                 <p style={{margin: \"2px\"}}>Polyline: Connections</p>\n//             </div>\n//             <div style={{position: \"absolute\", right: \"10px\"}}>\n//         <Button style={{marginTop: \"10px\"}}>Close</Button>\n//         </div>\n//             </div>\n//         </div>\n//     )\n// }\n// export default interactiveMap;\nimport React, { useState, useEffect } from 'react';\nimport MenuBar from './MenuBar';\nimport { Map, TileLayer, Tooltip, Circle } from 'react-leaflet';\nimport { Button } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport L from 'leaflet';\n\nvar InteractiveMap = function InteractiveMap(props) {\n  var initialLat = 1.462251; // Fallback latitude\n\n  var initialLng = 110.413307; // Fallback longitude\n  // State to control visibility of lines and store fetched data\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      hideLine = _useState2[0],\n      setHideLine = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      data = _useState4[0],\n      setData = _useState4[1];\n\n  var _useState5 = useState([initialLat, initialLng]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mapCenter = _useState6[0],\n      setMapCenter = _useState6[1]; // State to control map center\n  // Extracting case_id from props passed via routing\n\n\n  var _ref = props.location && props.location.state || {},\n      case_id = _ref.case_id;\n\n  useEffect(function () {\n    // URL to fetch data based on case_id\n    var url = \"http://mozzhub.fcsit.unimas.my/mozzhubAPI/mobMapData/\".concat(case_id);\n\n    function fetchData() {\n      return _fetchData.apply(this, arguments);\n    }\n\n    function _fetchData() {\n      _fetchData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var response, _data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return fetch(url);\n\n              case 3:\n                response = _context.sent;\n\n                if (response.ok) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error('Network response was not ok ' + response.statusText);\n\n              case 6:\n                _context.next = 8;\n                return response.json();\n\n              case 8:\n                _data = _context.sent;\n                // Store fetched data in state\n                setData(_data);\n\n                if (_data.length > 0) {\n                  // Update map center to the first data point's location\n                  setMapCenter([_data[0].lat, _data[0].lng]);\n                }\n\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n                console.error('There was a problem with the fetch operation:', _context.t0);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 13]]);\n      }));\n      return _fetchData.apply(this, arguments);\n    }\n\n    fetchData();\n  }, [case_id]); // Dependency array includes case_id to re-fetch if it changes\n  // Toggle function to hide/show lines\n\n  var handleClick = function handleClick() {\n    setHideLine(!hideLine);\n  }; // Function to handle Close button click\n\n\n  var handleCloseButton = function handleCloseButton() {\n    props.history.push('/record'); // Navigate to '/record' route\n  }; // Function to create a Bezier curve path\n\n\n  var createCurvePath = function createCurvePath(latlng1, latlng2) {\n    var midPoint = [(latlng1[0] + latlng2[0]) / 2, (latlng1[1] + latlng2[1]) / 2];\n    var controlPoint = [midPoint[0] + (latlng2[0] - latlng1[0]) * 0.1, midPoint[1] + (latlng2[1] - latlng1[1]) * 0.1];\n    return \"M \".concat(latlng1[1], \" \").concat(latlng1[0], \" Q \").concat(controlPoint[1], \" \").concat(controlPoint[0], \", \").concat(latlng2[1], \" \").concat(latlng2[0]);\n  };\n\n  return React.createElement(\"div\", {\n    style: {\n      backgroundColor: '',\n      width: '100%'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, React.createElement(MenuBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, React.createElement(Map, {\n    center: mapCenter,\n    zoom: 15,\n    style: {\n      width: '100%',\n      height: '580px',\n      zIndex: '0'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(TileLayer, {\n    attribution: \"&copy <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n    url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    maxZoom: 16,\n    minZoom: 2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }), data.map(function (elem, i) {\n    var l = (0.9 - data[i].ranking * 0.9) * 255;\n    var h = (0.9 - data[i].ranking * 0.9) * 240;\n    var a = data[i].ranking * 0.9;\n    var rgb = \"rgb(255,\" + l + \",\" + l + \")\";\n    return React.createElement(Circle, {\n      key: i,\n      center: {\n        lat: data[i].lat,\n        lng: data[i].lng\n      },\n      color: \"red\",\n      fillColor: \"red\",\n      fillOpacity: \"0.5\",\n      radius: 50,\n      onClick: handleClick // Toggle lines on circle click\n      ,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(Tooltip, {\n      style: {\n        maxWidth: \"150px\",\n        wordWrap: \"break-word\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Case ID: \", data[i].Case_id), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"Location: \", data[i].Location)));\n  }), !hideLine && data.length > 1 && React.createElement(\"svg\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, data.map(function (elem, i) {\n    if (i < data.length - 1) {\n      var path = createCurvePath([data[i].lat, data[i].lng], [data[i + 1].lat, data[i + 1].lng]);\n      return React.createElement(\"path\", {\n        d: path,\n        stroke: \"blue\",\n        fill: \"none\",\n        key: i,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      });\n    }\n\n    return null;\n  }))), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      marginLeft: '0px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      margin: \"2px\",\n      border: \"2px solid black\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    style: {\n      margin: \"2px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, \"Case ID:\", case_id), React.createElement(\"p\", {\n    style: {\n      margin: \"2px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, \"Location: \")), React.createElement(\"div\", {\n    style: {\n      position: \"absolute\",\n      right: \"10px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, React.createElement(Button, {\n    style: {\n      marginTop: \"10px\"\n    },\n    onClick: handleCloseButton,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, \"Close\")))));\n};\n\nexport default withRouter(InteractiveMap);","map":{"version":3,"sources":["D:\\MOZZHUB-ReactJS\\src\\component\\interactiveMap.js"],"names":["React","useState","useEffect","MenuBar","Map","TileLayer","Tooltip","Circle","Button","withRouter","L","InteractiveMap","props","initialLat","initialLng","hideLine","setHideLine","data","setData","mapCenter","setMapCenter","location","state","case_id","url","fetchData","fetch","response","ok","Error","statusText","json","length","lat","lng","console","error","handleClick","handleCloseButton","history","push","createCurvePath","latlng1","latlng2","midPoint","controlPoint","backgroundColor","width","height","zIndex","map","elem","i","l","ranking","h","a","rgb","maxWidth","wordWrap","Case_id","Location","path","display","flexDirection","marginLeft","margin","border","position","right","marginTop"],"mappings":"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","sourcesContent":["// import React, {useState} from 'react';\r\n// import { Map, TileLayer, Tooltip, Circle, Polyline } from 'react-leaflet';\r\n// import { Button } from 'semantic-ui-react';\r\n\r\n// const dummyRanking = [\r\n//     { lat: 1.462251, lng:  110.413307, ranking: 0.8 }, // London\r\n//     { lat: 1.468643, lng: 110.428541, ranking: 0.6 }, // New York\r\n//     { lat:  1.472410, lng: 110.420440, ranking: 0.4 }, // Los Angeles\r\n//     // { lat: 41.8781, lng: -87.6298, ranking: 0.5 }, // Chicago\r\n//     // { lat: 37.7749, lng: -122.4194, ranking: 0.7 } // San Francisco\r\n// ];\r\n\r\n// // const url = \"http://mozzhub.fcsit.unimas.my/mozzhubAPI/mobMapData/T1369\";\r\n\r\n// // async function fetchData() {\r\n// //     try {\r\n// //         const response = await fetch(url);\r\n// //         if (!response.ok) {\r\n// //             throw new Error('Network response was not ok ' + response.statusText);\r\n// //         }\r\n// //         const data = await response.json();\r\n\r\n// //         data.forEach(item => {\r\n// //             console.log(`Case ID: ${item.Case_id}, Latitude: ${item.lat}, Longitude: ${item.lng}`);\r\n// //         });\r\n// //     } catch (error) {\r\n// //         console.error('There was a problem with the fetch operation:', error);\r\n// //     }\r\n// // }\r\n\r\n// // fetchData();\r\n\r\n\r\n// const interactiveMap = () => {\r\n//     const lat = 1.462251; // Initial map center latitude\r\n//     const lng = 110.413307; // Initial map center longitude\r\n\r\n//     const[hideLine, setHideLine] = useState(false)\r\n\r\n//     const handleClick = ()=>{\r\n//         setHideLine(!hideLine);\r\n//     }\r\n\r\n//     const controlPoints = []; // Array to store control points for curves\r\n\r\n//     // Calculate control points\r\n//     for (let i = 0; i < dummyRanking.length - 1; i++) {\r\n//         const p1 = [dummyRanking[i].lat, dummyRanking[i].lng];\r\n//         const p2 = [dummyRanking[i + 1].lat, dummyRanking[i + 1].lng];\r\n\r\n//         const controlPoint = [\r\n//             (p1[0] + p2[0]) / 2, // Midpoint of latitudes\r\n//             (p1[1] + p2[1]) / 2, // Midpoint of longitudes\r\n//         ];\r\n\r\n//         controlPoints.push(controlPoint);\r\n//     }\r\n\r\n//     return (\r\n//         <div>\r\n//         <Map center={[lat, lng]} zoom={13} style={{ width: '100%', height: '620px', margin: 'auto' }}>\r\n//             <TileLayer\r\n//                 attribution=\"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors\"\r\n//                 url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n//                 maxZoom={16}\r\n//                 minZoom={2}\r\n//             />\r\n//             {dummyRanking.map((elem, i) => {\r\n//                 var l = (0.9 - dummyRanking[i].ranking * 0.9) * 255;\r\n//                 var h = (0.9 - dummyRanking[i].ranking * 0.9) * 240;\r\n//                 var a = dummyRanking[i].ranking * 0.9;\r\n//                 var rgb = \"rgb(255,\" + l + \",\" + l + \")\";\r\n//                 return (\r\n//                     <Circle\r\n//                         key={i}\r\n//                         center={{ lat: dummyRanking[i].lat, lng: dummyRanking[i].lng }}\r\n//                         color='red' \r\n//                         fillColor={rgb}\r\n//                         fillOpacity={a}\r\n//                         radius={50}\r\n//                         onClick={handleClick}\r\n//                         >\r\n//                         <Tooltip><h3>Ranking:#{i + 1}</h3></Tooltip>\r\n//                     </Circle>\r\n//                 )\r\n//             })}\r\n//             {/* Render curved lines between circles */}\r\n//             {!hideLine && dummyRanking.length > 1 && controlPoints.map((controlPoint, i) => (\r\n//                 <Polyline\r\n//                     key={i}\r\n//                     positions={[\r\n//                         [dummyRanking[i].lat, dummyRanking[i].lng], // Start point\r\n//                         controlPoint, // Control point\r\n//                         [dummyRanking[i + 1].lat, dummyRanking[i + 1].lng], // End point\r\n//                     ]}\r\n//                     color=\"blue\"\r\n//                 />\r\n//             ))}\r\n//         </Map>\r\n//         <div style={{ display: 'flex', flexDirection: 'column', marginLeft: '10px' }}>\r\n//         <div style={{margin: \"2px\", border: \"2px solid black\"}}>\r\n//                 <p style={{margin: \"2px\"}}>Map Legend:</p>\r\n//                 <p style={{margin: \"2px\"}}>Circle: Data points</p>\r\n//                 <p style={{margin: \"2px\"}}>Polyline: Connections</p>\r\n//             </div>\r\n//             <div style={{position: \"absolute\", right: \"10px\"}}>\r\n//         <Button style={{marginTop: \"10px\"}}>Close</Button>\r\n//         </div>\r\n//             </div>\r\n//         </div>\r\n//     )\r\n// }\r\n\r\n// export default interactiveMap;\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport MenuBar from './MenuBar';\r\nimport { Map, TileLayer, Tooltip, Circle } from 'react-leaflet';\r\nimport { Button } from 'semantic-ui-react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport L from 'leaflet';\r\n\r\nconst InteractiveMap = (props) => {\r\n    const initialLat = 1.462251; // Fallback latitude\r\n    const initialLng = 110.413307; // Fallback longitude\r\n\r\n    // State to control visibility of lines and store fetched data\r\n    const [hideLine, setHideLine] = useState(false);\r\n    const [data, setData] = useState([]);\r\n    const [mapCenter, setMapCenter] = useState([initialLat, initialLng]); // State to control map center\r\n\r\n    // Extracting case_id from props passed via routing\r\n    const { case_id } = (props.location && props.location.state) || {};\r\n\r\n    useEffect(() => {\r\n        // URL to fetch data based on case_id\r\n        const url = `http://mozzhub.fcsit.unimas.my/mozzhubAPI/mobMapData/${case_id}`;\r\n\r\n        async function fetchData() {\r\n            try {\r\n                const response = await fetch(url);\r\n                if (!response.ok) {\r\n                    throw new Error('Network response was not ok ' + response.statusText);\r\n                }\r\n                const data = await response.json();\r\n                // Store fetched data in state\r\n                setData(data);\r\n                if (data.length > 0) {\r\n                    // Update map center to the first data point's location\r\n                    setMapCenter([data[0].lat, data[0].lng]);\r\n                }\r\n            } catch (error) {\r\n                console.error('There was a problem with the fetch operation:', error);\r\n            }\r\n        }\r\n\r\n        fetchData();\r\n    }, [case_id]); // Dependency array includes case_id to re-fetch if it changes\r\n\r\n    // Toggle function to hide/show lines\r\n    const handleClick = () => {\r\n        setHideLine(!hideLine);\r\n    }\r\n\r\n    // Function to handle Close button click\r\n    const handleCloseButton = () => {\r\n        props.history.push('/record'); // Navigate to '/record' route\r\n    }\r\n\r\n    // Function to create a Bezier curve path\r\n    const createCurvePath = (latlng1, latlng2) => {\r\n        const midPoint = [\r\n            (latlng1[0] + latlng2[0]) / 2,\r\n            (latlng1[1] + latlng2[1]) / 2\r\n        ];\r\n        const controlPoint = [\r\n            midPoint[0] + (latlng2[0] - latlng1[0]) * 0.1, \r\n            midPoint[1] + (latlng2[1] - latlng1[1]) * 0.1\r\n        ];\r\n        return `M ${latlng1[1]} ${latlng1[0]} Q ${controlPoint[1]} ${controlPoint[0]}, ${latlng2[1]} ${latlng2[0]}`;\r\n    }\r\n\r\n    return (\r\n        <div style={{ backgroundColor: '', width: '100%' }}>\r\n            <MenuBar/>\r\n            <div>\r\n            <Map center={mapCenter} zoom={15} style={{ width: '100%', height: '580px', zIndex: '0' }}>\r\n                <TileLayer\r\n                    attribution=\"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors\"\r\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                    maxZoom={16}\r\n                    minZoom={2}\r\n                />\r\n                {data.map((elem, i) => {\r\n                    var l = (0.9 - data[i].ranking * 0.9) * 255;\r\n                    var h = (0.9 - data[i].ranking * 0.9) * 240;\r\n                    var a = data[i].ranking * 0.9;\r\n                    var rgb = \"rgb(255,\" + l + \",\" + l + \")\";\r\n                    return (\r\n                        <Circle\r\n                            key={i}\r\n                            center={{ lat: data[i].lat, lng: data[i].lng }}\r\n                            color='red'\r\n                            fillColor='red'\r\n                            fillOpacity='0.5'\r\n                            radius={50}\r\n                            onClick={handleClick} // Toggle lines on circle click\r\n                        >\r\n                            <Tooltip style={{ maxWidth: \"150px\", wordWrap: \"break-word\" }}>\r\n                                <h3>Case ID: {data[i].Case_id}</h3>\r\n                                <p>Location: {data[i].Location}</p>\r\n                            </Tooltip>\r\n                        </Circle>\r\n                    )\r\n                })}\r\n                {!hideLine && data.length > 1 && (\r\n                    <svg>\r\n                        {data.map((elem, i) => {\r\n                            if (i < data.length - 1) {\r\n                                const path = createCurvePath([data[i].lat, data[i].lng], [data[i + 1].lat, data[i + 1].lng]);\r\n                                return <path d={path} stroke=\"blue\" fill=\"none\" key={i} />;\r\n                            }\r\n                            return null;\r\n                        })}\r\n                    </svg>\r\n                )}\r\n            </Map>\r\n            <div style={{ display: 'flex', flexDirection: 'column', marginLeft: '0px' }}>\r\n                <div style={{ margin: \"2px\", border: \"2px solid black\"}}>\r\n                    <p style={{ margin: \"2px\" }}>Case ID:{case_id}</p>\r\n                    <p style={{ margin: \"2px\" }}>Location: </p>\r\n                </div>\r\n                <div style={{ position: \"absolute\", right: \"10px\" }}>\r\n                    <Button style={{ marginTop: \"10px\" }} onClick={handleCloseButton}>Close</Button>\r\n                </div>\r\n            </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withRouter(InteractiveMap);\r\n"]},"metadata":{},"sourceType":"module"}